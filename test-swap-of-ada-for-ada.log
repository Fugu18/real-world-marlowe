***** Test "Swap of ADA for ADA" *****
[Comment] Create the wallet for the ADA provider, fund it with 50 ADA, and activate the Marlowe endpoints.
[CreateWallet] Created wallet 14c2d7d08a59b77322e1c46c61aae6e5a7ccc20b for role "Ada provider".
[FundWallet] Funded wallet 14c2d7d08a59b77322e1c46c61aae6e5a7ccc20b for role "Ada provider" with valueFromList [(AdaAssetId,50000000)].
[ActivateApp] Activated MarloweApp instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 for role "Ada provider".
[Comment] Create the wallet for the other provider, fund it with 40 ADA, and activate the Marlowe endpoints.
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewObservableState Null.
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewYieldedExportTxs [].
[CreateWallet] Created wallet feaefbdd80abebdfec0912d2374153e62ded088a for role "Other provider".
[FundWallet] Funded wallet feaefbdd80abebdfec0912d2374153e62ded088a for role "Other provider" with valueFromList [(AdaAssetId,40000000)].
[ActivateApp] Activated MarloweApp instance ffa36740-6460-4955-8a46-beb50fa71e06 for role "Other provider".
[Comment] The ADA provider creates the swap contract for 30 ADA to 25 ADA.
[runContract] Instance ffa36740-6460-4955-8a46-beb50fa71e06 received NewObservableState Null.
[runContract] Instance ffa36740-6460-4955-8a46-beb50fa71e06 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance ffa36740-6460-4955-8a46-beb50fa71e06 received NewYieldedExportTxs [].
[CallCreate] Endpoint "create" called on instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 for owners [("Ada provider",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "2d11d378fe3ea29e2b43f7db8801bed61acab7dfde1dc111e0718a19")) (StakeRefBase (KeyHashObj (KeyHash "7d263bdf8394a4508f23f8d347ae1f126d708633006d4a633ef20c02"))))),("Other provider",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "4c619031d6c896e2b9ef40191e69730ac7f4fd45229084be6e526bad")) (StakeRefBase (KeyHashObj (KeyHash "7b4e66aa0c3e87b6f306adb1baae0eb5411bb400d217a97e4a7ee53f")))))].
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewActiveEndpoints [].
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewObservableState (Object (fromList [("contents",Array [String "60d11f9f-3d87-4451-94f7-ae439099c194",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "a9929f86ee40e0032a345952654a33a56339ee3299269d685d93a5f5"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "cea71498952d64cf94e2ca6bf603c293c96ac3f15f7608fff30e2228")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed with MarloweParams {rolePayoutValidatorHash = a9929f86ee40e0032a345952654a33a56339ee3299269d685d93a5f5, rolesCurrency = cea71498952d64cf94e2ca6bf603c293c96ac3f15f7608fff30e2228}.
[Comment] The ADA provider should have 46 ADA now, since 2 ADA was sent to the script when creating the contract and 2 ADA was sent to the other provider along with their role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Ada provider" contains valueFromList [(AdaAssetId,45505188),(AssetId "cea71498952d64cf94e2ca6bf603c293c96ac3f15f7608fff30e2228" "Ada provider",1)].
[Comment] The other provider should have 42 ADA.
[CheckFunds] Wallet for role "Other provider" contains valueFromList [(AdaAssetId,42000000),(AssetId "cea71498952d64cf94e2ca6bf603c293c96ac3f15f7608fff30e2228" "Other provider",1)].
[Comment] The other provider needs to followe the contract created by the ada provider.
[Follow] Instance ffa36740-6460-4955-8a46-beb50fa71e06 now follows instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163.
[Comment] The ADA provider deposits their 30 ADA for the swap.
[CallApplyInputs] Endpoint "apply-inputs" called on 7dac46b2-2803-4dfd-9669-bc3b9d34e163 for inputs [ClientInput (IDeposit "Ada provider" "Ada provider" (Token "" "") 30000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewActiveEndpoints [].
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewObservableState (Object (fromList [("contents",Array [String "f8191781-91cd-44f8-a0b2-73084ebaba06",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The ADA provider should have 16 ADA now, since they paid 30 ADA for the swap, minus up to an additional 2 ADA in fees.
[CheckFunds] Wallet for role "Ada provider" contains valueFromList [(AdaAssetId,14138992),(AssetId "cea71498952d64cf94e2ca6bf603c293c96ac3f15f7608fff30e2228" "Ada provider",1)].
[Comment] The other provider deposits their 25 ADA for the swap.
[CallApplyInputs] Endpoint "apply-inputs" called on ffa36740-6460-4955-8a46-beb50fa71e06 for inputs [ClientInput (IDeposit "Other provider" "Other provider" (Token "" "") 25000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance ffa36740-6460-4955-8a46-beb50fa71e06 received NewActiveEndpoints [].
[runContract] Instance ffa36740-6460-4955-8a46-beb50fa71e06 received NewObservableState (Object (fromList [("contents",Array [String "8edf2f49-6a9b-498e-afec-dedc5e22de95",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance ffa36740-6460-4955-8a46-beb50fa71e06 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The other provider should have 17 ADA, since they paid 25 USD for the swap, minus up to an additional 2 ADA in fees.
[CheckFunds] Wallet for role "Other provider" contains valueFromList [(AdaAssetId,15525180),(AssetId "cea71498952d64cf94e2ca6bf603c293c96ac3f15f7608fff30e2228" "Other provider",1)].
[Comment] Now the ADA provider redeems the 27 ADA from the payout script.
[CallRedeem] Endpoint "redeem" called on 7dac46b2-2803-4dfd-9669-bc3b9d34e163 for role "Ada provider".
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewActiveEndpoints [].
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewObservableState (Object (fromList [("contents",Array [String "edf14ad0-ca16-4c19-be58-9a155f392de9",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The ADA provider should now have 42 ADA, but they may have paid up to 4 ADA in fees.
[CheckFunds] Wallet for role "Ada provider" contains valueFromList [(AdaAssetId,40634916),(AssetId "cea71498952d64cf94e2ca6bf603c293c96ac3f15f7608fff30e2228" "Ada provider",1)].
[Comment] Now the other provider redeems the 30 ADA from the payout script.
[CallRedeem] Endpoint "redeem" called on ffa36740-6460-4955-8a46-beb50fa71e06 for role "Other provider".
[runContract] Instance ffa36740-6460-4955-8a46-beb50fa71e06 received NewActiveEndpoints [].
[runContract] Instance ffa36740-6460-4955-8a46-beb50fa71e06 received NewObservableState (Object (fromList [("contents",Array [String "6e7aa369-1f2c-4171-a288-4e6b43de6cf6",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance ffa36740-6460-4955-8a46-beb50fa71e06 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The other provider should now have 47 ADA, but they may have paid up to 3 ADA in fees.
[CheckFunds] Wallet for role "Other provider" contains valueFromList [(AdaAssetId,44990143),(AssetId "cea71498952d64cf94e2ca6bf603c293c96ac3f15f7608fff30e2228" "Other provider",1)].
[Comment] Stop the Marlowe application.
[runContract] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 received ContractFinished Nothing.
[Stop] Instance 7dac46b2-2803-4dfd-9669-bc3b9d34e163 stopped.
[Stop] Instance ffa36740-6460-4955-8a46-beb50fa71e06 stopped.
***** SUCCEEDED *****
