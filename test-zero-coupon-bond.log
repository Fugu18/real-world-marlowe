
***** Test "Zero-Coupon Bond" *****
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[CreateWallet] Created wallet de0ecf3784926b229bc444d4c9b45ca68c0c0e4d for role "Lender".
[FundWallet] Funded wallet de0ecf3784926b229bc444d4c9b45ca68c0c0e4d for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewObservableState Null.
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewYieldedExportTxs [].
[CreateWallet] Created wallet 598462b07812fd285e83626cacadcd82ee984d44 for role "Borrower".
[FundWallet] Funded wallet 598462b07812fd285e83626cacadcd82ee984d44 for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance 8cf76f41-221d-4d16-b3df-8e63fcec075c for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received NewObservableState Null.
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "2f0e7806056493907824e16dae1a02ba1f2a871f062c9c4be946d29e")) (StakeRefBase (KeyHashObj (KeyHash "95455132684285953bcc96735f9c85c7b85e622b59dbdda4715e945e"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "7a1adb2f4c376248280c0c375ea5475262d4a7d98706f018ef5cea45")) (StakeRefBase (KeyHashObj (KeyHash "8ea2fc39664a9f208b2b695711d75eb6254c1000a9e1ba1f5e446ddd")))))].
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewActiveEndpoints [].
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewObservableState (Object (fromList [("contents",Array [String "c79f7a1c-c3a8-46ed-bbf1-745df0a148b0",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "d806afbb8e645940cda1327169eaa7bbd65b3584a2df57257ead3d84"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed with MarloweParams {rolePayoutValidatorHash = d806afbb8e645940cda1327169eaa7bbd65b3584a2df57257ead3d84, rolesCurrency = 10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75537874),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c now follows instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3.
[Comment] The lender deposits the 50 ADA loan amount.
[CallApplyInputs] Endpoint "apply-inputs" called on 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 for inputs [ClientInput (IDeposit "Lender" "Lender" (Token "" "") 50000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewActiveEndpoints [].
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewObservableState (Object (fromList [("contents",Array [String "b64c0f23-5486-4e96-b840-868fe559cc08",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender will have 50 ADA less for the loan and may have paid up to another 2 ADA in fees, leaving a balance of 26 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,24209337),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Borrower",1)].
[Comment] Now the borrower redeems the 50 ADA from the payout script.
[CallRedeem] Endpoint "redeem" called on 8cf76f41-221d-4d16-b3df-8e63fcec075c for role "Borrower".
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received NewActiveEndpoints [].
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received NewObservableState (Object (fromList [("contents",Array [String "4eb2b4f6-743f-4739-80b3-c1db78d52560",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender's funds are unchanged.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,24209337),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Lender",1)].
[Comment] The borrower has an additional 50 ADA but may have paid up to 1 ADA in fees for the redemption, leaving a balance of 62 ADA minus up to 1 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,61580046),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Borrower",1)].
[Comment] The borrower pays back the 53 ADA of loan plus interest.
[CallApplyInputs] Endpoint "apply-inputs" called on 8cf76f41-221d-4d16-b3df-8e63fcec075c for inputs [ClientInput (IDeposit "Borrower" "Borrower" (Token "" "") 53000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received NewActiveEndpoints [].
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received NewObservableState (Object (fromList [("contents",Array [String "5c663edf-da78-463e-a534-d591669fd26d",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] Because the contract is closed when the borrower makes their deposit, the lender receives back their 2 ADA that they contributed to create the contract.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,26209337),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Lender",1)].
[Comment] The borrower has 53 ADA less and may have paid another 2 ADA in fees, leaving a balance of 9 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7401369),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Borrower",1)].
[Comment] The lender redeems the 53 ADA.
[CallRedeem] Endpoint "redeem" called on 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 for role "Lender".
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewActiveEndpoints [].
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewObservableState (Object (fromList [("contents",Array [String "a586eea7-851f-42ca-b97e-63e7e3d4ae48",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender now has an additional 53 ADA but may have paid another 1 ADA in fees, leaving a balance of 81 ADA minus up to 4 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,78693921),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7401369),(AssetId "10dad144a86e4896dbbf53e7644b6cf2f323e5ca0a442baf79226615" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet de0ecf3784926b229bc444d4c9b45ca68c0c0e4d.
[ReturnFunds] Returned funds from wallet 598462b07812fd285e83626cacadcd82ee984d44.
[Comment] Stop the Marlowe application.
[runContract] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 received ContractFinished Nothing.
[Stop] Instance 7d72f08c-dda7-4b8e-81d1-5b45aa92afa3 stopped.
[Stop] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c stopped.
***** SUCCEEDED *****
[runContract] Instance 8cf76f41-221d-4d16-b3df-8e63fcec075c received ContractFinished Nothing.
