
***** Test "Zero-Coupon Bond" *****
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[createWallet] Mnemonic sentence is "buffalo fence hotel city index voice junior plug notice fuel draft twelve cluster subject oxygen setup badge roof report enroll wheat pupil anchor slow".
[createWallet] First wallet address is addr_test1qz24wr6g8heg86ntz0r9urkyhn0hdlcneyhwuxwxfs9vd70xxn4f6xwhpdwywa809n46dkp8uyx8ay5c5hysnv6vn9hsc5gqmt.
[createWallet] First public key hash is 95570f483df283ea6b13c65e0ec4bcdf76ff13c92eee19c64c0ac6f9.
[CreateWallet] Created wallet identified as c4a58f6fc4f3ade9d5803dc32124e4f4752a31e6 for role "Lender".
[FundWallet] Funded wallet for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance "LenderApp" with identifier a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewObservableState Null.
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewYieldedExportTxs [].
[createWallet] Mnemonic sentence is "middle dolphin cabin famous tomorrow hybrid struggle tackle provide large easy express beauty often better rubber chuckle coach valley dial earn divorce report shy".
[createWallet] First wallet address is addr_test1qpqmv830hz462kg8g0d4v79jmz960savnlma28qtrm0hqtm4zpwregk87qvpwyekhqdkl99ll7lzr5vm0ey234j852kqraqcar.
[createWallet] First public key hash is 41b61e2fb8aba5590743db5678b2d88ba7c3ac9ff7d51c0b1edf702f.
[CreateWallet] Created wallet identified as 173d50acd3a889319a361392796a64ae9e7d672c for role "Borrower".
[FundWallet] Funded wallet for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance "BorrowerApp" with identifier 3099cb55-50ea-4360-a78a-c0eafc66e45e for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance 3099cb55-50ea-4360-a78a-c0eafc66e45e received NewObservableState Null.
[runContract] Instance 3099cb55-50ea-4360-a78a-c0eafc66e45e received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 3099cb55-50ea-4360-a78a-c0eafc66e45e received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance "LenderApp" for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "95570f483df283ea6b13c65e0ec4bcdf76ff13c92eee19c64c0ac6f9")) (StakeRefBase (KeyHashObj (KeyHash "e634ea9d19d70b5c4774ef2ceba6d827e10c7e9298a5c909b34c996f"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "41b61e2fb8aba5590743db5678b2d88ba7c3ac9ff7d51c0b1edf702f")) (StakeRefBase (KeyHashObj (KeyHash "75105c3ca2c7f018171336b81b6f94bfffbe21d19b7e48a8d647a2ac")))))].
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewActiveEndpoints [].
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewObservableState (Object (fromList [("contents",Array [String "ce001477-3c1b-4d2a-bd16-307f28ca9b41",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "bdf7fcdb90f0cc61d0af38a5faa834a18efd8c9e20c1217e15077a89"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed for app address addr_test1wqryg06ffuam3wm0xvqcw3wayuh077cx86csqamgvhuvmsswr6khp and role address addr_test1wz7l0lxmjrcvccws4uu2t74gxjscalvvncsvzgt7z5rh4zgchrxhm with MarloweParams {rolePayoutValidatorHash = bdf7fcdb90f0cc61d0af38a5faa834a18efd8c9e20c1217e15077a89, rolesCurrency = 5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75537874),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance "BorrowerApp" now follows instance "LenderApp".
[Comment] The lender deposits the 50 ADA loan amount.
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewActiveEndpoints [].
[CallApplyInputs] Endpoint "apply-inputs" called on instance "LenderApp" for inputs [ClientInput (IDeposit "Lender" "Lender" (Token "" "") 50000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewObservableState (Object (fromList [("contents",Array [String "93c6d458-e5af-44a4-bfcb-f2fb7880f5aa",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender will have 50 ADA less for the loan and may have paid up to another 2 ADA in fees, leaving a balance of 26 ADA minus up to 3 ADA in fees.
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,24209337),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Borrower",1)].
[Comment] Now the borrower redeems the 50 ADA from the payout script.
[runContract] Instance 3099cb55-50ea-4360-a78a-c0eafc66e45e received NewActiveEndpoints [].
[CallRedeem] Endpoint "redeem" called on instance "BorrowerApp" for role "Borrower".
[runContract] Instance 3099cb55-50ea-4360-a78a-c0eafc66e45e received NewObservableState (Object (fromList [("contents",Array [String "3e8d2915-3eaf-4f82-84bb-9ec38c865621",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 3099cb55-50ea-4360-a78a-c0eafc66e45e received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender's funds are unchanged.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,24209337),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Lender",1)].
[Comment] The borrower has an additional 50 ADA but may have paid up to 1 ADA in fees for the redemption, leaving a balance of 62 ADA minus up to 1 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,61574241),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Borrower",1)].
[Comment] The borrower pays back the 53 ADA of loan plus interest.
[runContract] Instance 3099cb55-50ea-4360-a78a-c0eafc66e45e received NewActiveEndpoints [].
[CallApplyInputs] Endpoint "apply-inputs" called on instance "BorrowerApp" for inputs [ClientInput (IDeposit "Borrower" "Borrower" (Token "" "") 53000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance 3099cb55-50ea-4360-a78a-c0eafc66e45e received NewObservableState (Object (fromList [("contents",Array [String "4350843e-0d8f-483e-9144-c4f24751d74b",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 3099cb55-50ea-4360-a78a-c0eafc66e45e received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] Because the contract is closed when the borrower makes their deposit, the lender receives back their 2 ADA that they contributed to create the contract.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,26209337),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Lender",1)].
[Comment] The borrower has 53 ADA less and may have paid another 2 ADA in fees, leaving a balance of 9 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7395564),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Borrower",1)].
[Comment] The lender redeems the 53 ADA.
[CallRedeem] Endpoint "redeem" called on instance "LenderApp" for role "Lender".
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewActiveEndpoints [].
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewObservableState (Object (fromList [("contents",Array [String "2219516a-5ea6-4f32-8520-980b1a07ba20",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender now has an additional 53 ADA but may have paid another 1 ADA in fees, leaving a balance of 81 ADA minus up to 4 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,78693921),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7395564),(AssetId "5bd3d9fe2774d9627458f79eea26ab2f7853993a7900cfbdd1700cd8" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet for role "Lender".
[ReturnFunds] Returned funds from wallet for role "Borrower".
[Comment] Stop the Marlowe application.
[runContract] Instance a96f3f8d-c2c5-47be-8f09-5bd6c1909eb9 received ContractFinished Nothing.
[Stop] Instance "LenderApp" stopped.
[Stop] Instance "BorrowerApp" stopped.
***** PASSED *****
