
***** Test "Zero-Coupon Bond" *****
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[createWallet] Mnemonic sentence is "supply oblige art trophy sad quiz derive roof cliff post curve budget sister abstract receive auto outside floor fiscal soul crumble teach satoshi barrel".
[createWallet] First wallet address is addr_test1qzqlg2l8q2zdylpre004ydx9uhwuxdvcfhcwwj8rjqjhjk3tsxm0ng6lw4kux3pfj4qqmn5cqrzes7prhrpvxqaxqz0qjwag2t.
[createWallet] First public key hash is 81f42be70284d27c23cbdf5234c5e5ddc335984df0e748e39025795a.
[CreateWallet] Created wallet identified as d38ba76ff0f31f7bce8a543e6c815a6fb1b29943 for role "Lender".
[FundWallet] Funded wallet for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance "LenderApp" with identifier 10b0fa41-aadf-4248-97b8-c91de5d88381 for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewObservableState Null.
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewYieldedExportTxs [].
[createWallet] Mnemonic sentence is "legal zone extend chest salute penalty smile path giant diagram any run worry viable border alien mammal device bomb cushion check volume lab accident".
[createWallet] First wallet address is addr_test1qz0axw253rzz86tp56f9j30lj4mna8aupm0whp9zlkc9tn2uya00kyau6rcxa3rqxqke0fkst6h6cv8al79h8s5n2g7qh0krpe.
[createWallet] First public key hash is 9fd3395488c423e961a6925945ff95773e9fbc0edeeb84a2fdb055cd.
[CreateWallet] Created wallet identified as 5a605a8999b02dd299c7ed1184db347eb8db669b for role "Borrower".
[FundWallet] Funded wallet for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance "BorrowerApp" with identifier e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 received NewObservableState Null.
[runContract] Instance e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance "LenderApp" for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "81f42be70284d27c23cbdf5234c5e5ddc335984df0e748e39025795a")) (StakeRefBase (KeyHashObj (KeyHash "2b81b6f9a35f756dc3442995400dce9800c5987823b8c2c303a6009e"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "9fd3395488c423e961a6925945ff95773e9fbc0edeeb84a2fdb055cd")) (StakeRefBase (KeyHashObj (KeyHash "5c275efb13bcd0f06ec460302d97a6d05eafac30fdff8b73c293523c")))))].
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewActiveEndpoints [].
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewObservableState (Object (fromList [("contents",Array [String "61917fa5-b762-468d-9e11-64d300b36e80",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "70d94e4e6fa6966d5aa41a26825983231fb506c66ee4ca0aa324fd7a"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed for app address addr_test1wpf9cmld2xfdxu2wkrj5zdpfr2krslqx3a0snjlldyyu8hqqgtzuq and role address addr_test1wpcdjnjwd7nfvm265sdzdqjesv33ldgxcehwfjs25vj067s8cr8ev with MarloweParams {rolePayoutValidatorHash = 70d94e4e6fa6966d5aa41a26825983231fb506c66ee4ca0aa324fd7a, rolesCurrency = 3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75537874),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance "BorrowerApp" now follows instance "LenderApp".
[Comment] The lender deposits the 50 ADA loan amount.
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewActiveEndpoints [].
[CallApplyInputs] Endpoint "apply-inputs" called on instance "LenderApp" for inputs [ClientInput (IDeposit "Lender" "Lender" (Token "" "") 50000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewObservableState (Object (fromList [("contents",Array [String "73d01dd6-e072-4447-acee-4f5f0f2565ae",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender will have 50 ADA less for the loan and may have paid up to another 2 ADA in fees, leaving a balance of 26 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,23999724),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Borrower",1)].
[Comment] Now the borrower redeems the 50 ADA from the payout script.
[runContract] Instance e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 received NewActiveEndpoints [].
[CallRedeem] Endpoint "redeem" called on instance "BorrowerApp" for role "Borrower".
[runContract] Instance e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 received NewObservableState (Object (fromList [("contents",Array [String "8fe57bd2-3052-4d60-ade0-8ab9a73f221d",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender's funds are unchanged.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,23999724),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Lender",1)].
[Comment] The borrower has an additional 50 ADA but may have paid up to 1 ADA in fees for the redemption, leaving a balance of 62 ADA minus up to 1 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,61569899),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Borrower",1)].
[Comment] The borrower pays back the 53 ADA of loan plus interest.
[runContract] Instance e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 received NewActiveEndpoints [].
[CallApplyInputs] Endpoint "apply-inputs" called on instance "BorrowerApp" for inputs [ClientInput (IDeposit "Borrower" "Borrower" (Token "" "") 53000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 received NewObservableState (Object (fromList [("contents",Array [String "baa5fb20-b9df-4c82-a081-6932863f8461",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[AwaitApplyInputs] Input application confirmed.
[Comment] Because the contract is closed when the borrower makes their deposit, the lender receives back their 2 ADA that they contributed to create the contract.
[runContract] Instance e8678c8f-ba01-4439-ad4e-2ba0f98e2fc5 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,25999724),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Lender",1)].
[Comment] The borrower has 53 ADA less and may have paid another 2 ADA in fees, leaving a balance of 9 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7345313),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Borrower",1)].
[Comment] The lender redeems the 53 ADA.
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewActiveEndpoints [].
[CallRedeem] Endpoint "redeem" called on instance "LenderApp" for role "Lender".
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewObservableState (Object (fromList [("contents",Array [String "0e5e63bc-ab4a-4460-a8e6-83a916b8d8b1",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender now has an additional 53 ADA but may have paid another 1 ADA in fees, leaving a balance of 81 ADA minus up to 4 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,78495916),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7345313),(AssetId "3476f4adaec7f5b902b9a8c40d70d68d0b7d0494669d08b6629e91b6" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet for role "Lender".
[ReturnFunds] Returned funds from wallet for role "Borrower".
[Comment] Stop the Marlowe application.
[runContract] Instance 10b0fa41-aadf-4248-97b8-c91de5d88381 received ContractFinished Nothing.
[Stop] Instance "LenderApp" stopped.
[Stop] Instance "BorrowerApp" stopped.
***** PASSED *****
