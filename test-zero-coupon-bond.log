
***** Test "Zero-Coupon Bond" *****
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[createWallet] Mnemonic sentence is "task balance cover have topic anchor economy remain elegant bind install enact actress spy unhappy tilt phrase catalog two sheriff that reveal shield shield".
[createWallet] First wallet address is addr_test1qrdle93sq6e5pl73q59dh32u8wutsmhywgumg36vr0c562rf0d7522wls6xng6n5txuzmh3pjy79qnpge6qc2sagw7yquykwkc.
[createWallet] First public key hash is dbfc963006b340ffd1050adbc55c3bb8b86ee47239b4474c1bf14d28.
[CreateWallet] Created wallet identified as d87a20ba18ab38995162dd4ce530c496acb66f40 for role "Lender".
[FundWallet] Funded wallet for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance "LenderApp" with identifier 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewObservableState Null.
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewYieldedExportTxs [].
[createWallet] Mnemonic sentence is "pear bachelor frozen fog tone breeze alter bullet satoshi supply minute cream guilt february sunset nice scan place tragic spike kitten problem timber twice".
[createWallet] First wallet address is addr_test1qrwnareefp7jscfdqu2mch082xpgfcfy69patws3d7tme4nddzre2kld7chlhuwnhganr3xhyccxfvl5za687lypq0vs8zznxy.
[createWallet] First public key hash is dd3e8f39487d28612d0715bc5de7518284e124d143d5ba116f97bcd6.
[CreateWallet] Created wallet identified as 7740d6802ec7bd0c668fe5610fbb2be638794c24 for role "Borrower".
[FundWallet] Funded wallet for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance "BorrowerApp" with identifier d4dcf232-879b-4be4-913a-a8383daeefa0 for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance d4dcf232-879b-4be4-913a-a8383daeefa0 received NewObservableState Null.
[runContract] Instance d4dcf232-879b-4be4-913a-a8383daeefa0 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance d4dcf232-879b-4be4-913a-a8383daeefa0 received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance "LenderApp" for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "dbfc963006b340ffd1050adbc55c3bb8b86ee47239b4474c1bf14d28")) (StakeRefBase (KeyHashObj (KeyHash "697b7d4529df868d346a7459b82dde21913c504c28ce818543a87788"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "dd3e8f39487d28612d0715bc5de7518284e124d143d5ba116f97bcd6")) (StakeRefBase (KeyHashObj (KeyHash "6d6887955bedf62ffbf1d3ba3b31c4d7263064b3f417747f7c8103d9")))))].
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewActiveEndpoints [].
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewObservableState (Object (fromList [("contents",Array [String "25492e83-daf1-4444-84a1-f9a34e3e1039",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "68334b2ffa10dd6443151b52dead7ab943839d4a455844d1008f1c1b"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed for app address addr_test1wzrdv0v25hacyg7hs00x556k9h0kzskp52revernze0h2nqqhtget and role address addr_test1wp5rxje0lggd6ezrz5d49h4d02u58quaffz4s3x3qz83cxcfpzzh7 with MarloweParams {rolePayoutValidatorHash = 68334b2ffa10dd6443151b52dead7ab943839d4a455844d1008f1c1b, rolesCurrency = 3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75537874),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance "BorrowerApp" now follows instance "LenderApp".
[Comment] The lender deposits the 50 ADA loan amount.
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewActiveEndpoints [].
[CallApplyInputs] Endpoint "apply-inputs" called on instance "LenderApp" for inputs [ClientInput (IDeposit "Lender" "Lender" (Token "" "") 50000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewObservableState (Object (fromList [("contents",Array [String "f64113eb-6251-4956-b902-e46ba5406d2f",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender will have 50 ADA less for the loan and may have paid up to another 2 ADA in fees, leaving a balance of 26 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,23999900),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Borrower",1)].
[Comment] Now the borrower redeems the 50 ADA from the payout script.
[runContract] Instance d4dcf232-879b-4be4-913a-a8383daeefa0 received NewActiveEndpoints [].
[CallRedeem] Endpoint "redeem" called on instance "BorrowerApp" for role "Borrower".
[runContract] Instance d4dcf232-879b-4be4-913a-a8383daeefa0 received NewObservableState (Object (fromList [("contents",Array [String "cd1e0d8e-ab66-492d-938c-6ab8fb054a8a",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance d4dcf232-879b-4be4-913a-a8383daeefa0 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender's funds are unchanged.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,23999900),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Lender",1)].
[Comment] The borrower has an additional 50 ADA but may have paid up to 1 ADA in fees for the redemption, leaving a balance of 62 ADA minus up to 1 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,61574241),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Borrower",1)].
[Comment] The borrower pays back the 53 ADA of loan plus interest.
[runContract] Instance d4dcf232-879b-4be4-913a-a8383daeefa0 received NewActiveEndpoints [].
[CallApplyInputs] Endpoint "apply-inputs" called on instance "BorrowerApp" for inputs [ClientInput (IDeposit "Borrower" "Borrower" (Token "" "") 53000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance d4dcf232-879b-4be4-913a-a8383daeefa0 received NewObservableState (Object (fromList [("contents",Array [String "0a1ea8cd-2a7d-4a13-9895-e526ccd19284",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance d4dcf232-879b-4be4-913a-a8383daeefa0 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] Because the contract is closed when the borrower makes their deposit, the lender receives back their 2 ADA that they contributed to create the contract.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,25999900),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Lender",1)].
[Comment] The borrower has 53 ADA less and may have paid another 2 ADA in fees, leaving a balance of 9 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7349831),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Borrower",1)].
[Comment] The lender redeems the 53 ADA.
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewActiveEndpoints [].
[CallRedeem] Endpoint "redeem" called on instance "LenderApp" for role "Lender".
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewObservableState (Object (fromList [("contents",Array [String "5a506479-ec3d-462f-9c79-1e37817863c6",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender now has an additional 53 ADA but may have paid another 1 ADA in fees, leaving a balance of 81 ADA minus up to 4 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,78484484),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7349831),(AssetId "3bdb7d7bf4f1453bd572add086638c4201ae7724ba05d9ec3697c1b2" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet for role "Lender".
[ReturnFunds] Returned funds from wallet for role "Borrower".
[Comment] Stop the Marlowe application.
[runContract] Instance 87ab5434-cd6b-4600-9ecd-6c21f8c4e231 received ContractFinished Nothing.
[Stop] Instance "LenderApp" stopped.
[Stop] Instance "BorrowerApp" stopped.
***** PASSED *****
