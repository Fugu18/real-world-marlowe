
***** Test "Zero-Coupon Bond" *****
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[createWallet] Mnemonic sentence is "bottom this slender lottery doctor decorate solar north math later kid aim slow brick forget bonus crunch impact ripple laundry orphan fatigue unaware dial".
[createWallet] First wallet address is addr_test1qrw052duf026vr2phnrvwh7qedex2kx08mz4ysrneqld47avej6qrffaqqgzc76xagyux5f539mj27dvlzlmc3x39nusdwt09r.
[createWallet] First public key hash is dcfa29bc4bd5a60d41bcc6c75fc0cb726558cf3ec5524073c83edafb.
[CreateWallet] Created wallet identified as 533c9c44357dd55f74a3bd2e2811415a14b8e636 for role "Lender".
[FundWallet] Funded wallet for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance "LenderApp" with identifier e4575651-fc10-483a-8fa2-2a0bf28f0565 for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewObservableState Null.
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewYieldedExportTxs [].
[createWallet] Mnemonic sentence is "reunion horror foam valley flash egg room kingdom possible few grace weasel hazard ensure when chunk hammer wife tell panic vote never glance lend".
[createWallet] First wallet address is addr_test1qzx9608jdx9x3fdk4xsxuneq35wrngvhavymckadqf8mmk9uuk0l8x67yq30j6przl44wlfvn8vdjw5sqs8d05vcfajqedzm58.
[createWallet] First public key hash is 8c5d3cf2698a68a5b6a9a06e4f208d1c39a197eb09bc5bad024fbdd8.
[CreateWallet] Created wallet identified as e90b872a0d62b91cb545c7688572edbac326e5e9 for role "Borrower".
[FundWallet] Funded wallet for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance "BorrowerApp" with identifier b6eda72b-3848-41e6-823b-8fdefb91fd9b for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance b6eda72b-3848-41e6-823b-8fdefb91fd9b received NewObservableState Null.
[runContract] Instance b6eda72b-3848-41e6-823b-8fdefb91fd9b received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance b6eda72b-3848-41e6-823b-8fdefb91fd9b received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance "LenderApp" for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "dcfa29bc4bd5a60d41bcc6c75fc0cb726558cf3ec5524073c83edafb")) (StakeRefBase (KeyHashObj (KeyHash "acccb401a53d00102c7b46ea09c3513489772579acf8bfbc44d12cf9"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "8c5d3cf2698a68a5b6a9a06e4f208d1c39a197eb09bc5bad024fbdd8")) (StakeRefBase (KeyHashObj (KeyHash "bce59ff39b5e2022f9682317eb577d2c99d8d93a90040ed7d1984f64")))))].
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewActiveEndpoints [].
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewObservableState (Object (fromList [("contents",Array [String "bd4285c3-e90b-4c9e-a63b-9ef989d9aef1",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "f8fea690fcd8ac3d017419b15b23245e90af12b25632884ff2f6d25f"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed for app address addr_test1wrzfthvvthch5ly4wakk2t6gd2hvw9a6ma8h2uepqvavqccrj274r and role address addr_test1wru0af5slnv2c0gpwsvmzkery30fptcjkftr9zz07tmdyhcufu09w with MarloweParams {rolePayoutValidatorHash = f8fea690fcd8ac3d017419b15b23245e90af12b25632884ff2f6d25f, rolesCurrency = b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75537874),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance "BorrowerApp" now follows instance "LenderApp".
[Comment] The lender deposits the 50 ADA loan amount.
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewActiveEndpoints [].
[CallApplyInputs] Endpoint "apply-inputs" called on instance "LenderApp" for inputs [ClientInput (IDeposit "Lender" "Lender" (Token "" "") 50000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewObservableState (Object (fromList [("contents",Array [String "965d0db6-eaaf-420a-b715-9c1456795025",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender will have 50 ADA less for the loan and may have paid up to another 2 ADA in fees, leaving a balance of 26 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,23999900),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Borrower",1)].
[Comment] Now the borrower redeems the 50 ADA from the payout script.
[runContract] Instance b6eda72b-3848-41e6-823b-8fdefb91fd9b received NewActiveEndpoints [].
[CallRedeem] Endpoint "redeem" called on instance "BorrowerApp" for role "Borrower".
[runContract] Instance b6eda72b-3848-41e6-823b-8fdefb91fd9b received NewObservableState (Object (fromList [("contents",Array [String "f9188096-3465-4b9b-9175-8e1491beb1a1",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance b6eda72b-3848-41e6-823b-8fdefb91fd9b received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender's funds are unchanged.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,23999900),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Lender",1)].
[Comment] The borrower has an additional 50 ADA but may have paid up to 1 ADA in fees for the redemption, leaving a balance of 62 ADA minus up to 1 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,61574241),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Borrower",1)].
[Comment] The borrower pays back the 53 ADA of loan plus interest.
[runContract] Instance b6eda72b-3848-41e6-823b-8fdefb91fd9b received NewActiveEndpoints [].
[CallApplyInputs] Endpoint "apply-inputs" called on instance "BorrowerApp" for inputs [ClientInput (IDeposit "Borrower" "Borrower" (Token "" "") 53000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance b6eda72b-3848-41e6-823b-8fdefb91fd9b received NewObservableState (Object (fromList [("contents",Array [String "dfe69ef2-f4d5-491a-b3dc-c2449f6b1b0f",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance b6eda72b-3848-41e6-823b-8fdefb91fd9b received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] Because the contract is closed when the borrower makes their deposit, the lender receives back their 2 ADA that they contributed to create the contract.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,25999900),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Lender",1)].
[Comment] The borrower has 53 ADA less and may have paid another 2 ADA in fees, leaving a balance of 9 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7349831),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Borrower",1)].
[Comment] The lender redeems the 53 ADA.
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewActiveEndpoints [].
[CallRedeem] Endpoint "redeem" called on instance "LenderApp" for role "Lender".
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewObservableState (Object (fromList [("contents",Array [String "9a413184-0bc9-4b4b-97fb-a41ca98f6742",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender now has an additional 53 ADA but may have paid another 1 ADA in fees, leaving a balance of 81 ADA minus up to 4 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,78484484),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7349831),(AssetId "b1efe21923017498547a544ad4b3909f7b32396c9b89c55c93c8c845" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet for role "Lender".
[ReturnFunds] Returned funds from wallet for role "Borrower".
[Comment] Stop the Marlowe application.
[runContract] Instance e4575651-fc10-483a-8fa2-2a0bf28f0565 received ContractFinished Nothing.
[Stop] Instance "LenderApp" stopped.
[Stop] Instance "BorrowerApp" stopped.
***** PASSED *****
