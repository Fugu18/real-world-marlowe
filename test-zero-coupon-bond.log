
***** Test "Zero-Coupon Bond" *****
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[CreateWallet] Created wallet 734456dfaf92ead6cb1747161c7448fa71cbd6eb for role "Lender".
[FundWallet] Funded wallet 734456dfaf92ead6cb1747161c7448fa71cbd6eb for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewObservableState Null.
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewYieldedExportTxs [].
[CreateWallet] Created wallet 79332004207dddc7896f70fadc616243741bd127 for role "Borrower".
[FundWallet] Funded wallet 79332004207dddc7896f70fadc616243741bd127 for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance af96e390-a708-4b5d-9496-fb25143cf64f for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance af96e390-a708-4b5d-9496-fb25143cf64f received NewObservableState Null.
[runContract] Instance af96e390-a708-4b5d-9496-fb25143cf64f received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance af96e390-a708-4b5d-9496-fb25143cf64f received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "65c9a0bcef4af2ee73d257c9223cace27f511a31da638591cddce7da")) (StakeRefBase (KeyHashObj (KeyHash "2849e03a74c9348ff3267b43242a45fefddfa151ca3df72dfe79780c"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "ac3f7a782da138ae772b86dd3e32c0380f31c9d24b7bdeeeae39896a")) (StakeRefBase (KeyHashObj (KeyHash "9247d4930ff50f1a468e038ce0fe930f8fc0665883ba977ed9df271c")))))].
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewActiveEndpoints [].
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewObservableState (Object (fromList [("contents",Array [String "7e54044e-96d1-4f30-851e-af9fa56535a7",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "8e09cb82fc8f8de805718c7c9e62dc3d45fb59b9eb43780e669119ca"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed with MarloweParams {rolePayoutValidatorHash = 8e09cb82fc8f8de805718c7c9e62dc3d45fb59b9eb43780e669119ca, rolesCurrency = 8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75509500),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance af96e390-a708-4b5d-9496-fb25143cf64f now follows instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad.
[Comment] The lender deposits the 50 ADA loan amount.
[CallApplyInputs] Endpoint "apply-inputs" called on 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad for inputs [ClientInput (IDeposit "Lender" "Lender" (Token "" "") 50000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewActiveEndpoints [].
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewObservableState (Object (fromList [("contents",Array [String "651ebd37-a3a0-433c-a12d-2c7af53d5712",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender will have 50 ADA less for the loan and may have paid up to another 2 ADA in fees, leaving a balance of 26 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,24017591),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Borrower",1)].
[Comment] Now the borrower redeems the 50 ADA from the payout script.
[CallRedeem] Endpoint "redeem" called on af96e390-a708-4b5d-9496-fb25143cf64f for role "Borrower".
[runContract] Instance af96e390-a708-4b5d-9496-fb25143cf64f received NewActiveEndpoints [].
[runContract] Instance af96e390-a708-4b5d-9496-fb25143cf64f received NewObservableState (Object (fromList [("contents",Array [String "e7d55d91-d0ec-46f1-9e33-4e127787177b",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance af96e390-a708-4b5d-9496-fb25143cf64f received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender's funds are unchanged.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,24017591),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Lender",1)].
[Comment] The borrower has an additional 50 ADA but may have paid up to 1 ADA in fees for the redemption, leaving a balance of 62 ADA minus up to 1 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,61545077),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Borrower",1)].
[Comment] The borrower pays back the 53 ADA of loan plus interest.
[CallApplyInputs] Endpoint "apply-inputs" called on af96e390-a708-4b5d-9496-fb25143cf64f for inputs [ClientInput (IDeposit "Borrower" "Borrower" (Token "" "") 53000000)] and times Just (POSIXTime {getPOSIXTime = 1645590825000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance af96e390-a708-4b5d-9496-fb25143cf64f received NewActiveEndpoints [].
[runContract] Instance af96e390-a708-4b5d-9496-fb25143cf64f received NewObservableState (Object (fromList [("contents",Array [String "44aa777d-c63b-4304-a6b9-73983528b5cb",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance af96e390-a708-4b5d-9496-fb25143cf64f received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] Because the contract is closed when the borrower makes their deposit, the lender receives back their 2 ADA that they contributed to create the contract.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,26017591),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Lender",1)].
[Comment] The borrower has 53 ADA less and may have paid another 2 ADA in fees, leaving a balance of 9 ADA minus up to 3 ADA in fees.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7217521),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Borrower",1)].
[Comment] The lender redeems the 53 ADA.
[CallRedeem] Endpoint "redeem" called on 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad for role "Lender".
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewActiveEndpoints [].
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewObservableState (Object (fromList [("contents",Array [String "9044f2ed-3605-4463-8f98-abee0aa4e3cb",Object (fromList [("tag",String "RedeemResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitRedeem] Redemption confirmed.
[Comment] The lender now has an additional 53 ADA but may have paid another 1 ADA in fees, leaving a balance of 81 ADA minus up to 4 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,78469079),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,7217521),(AssetId "8427520fdc10a43bf3b1acfacd02b1f9e87423686ea66edef70f80f0" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet 734456dfaf92ead6cb1747161c7448fa71cbd6eb.
[ReturnFunds] Returned funds from wallet 79332004207dddc7896f70fadc616243741bd127.
[Comment] Stop the Marlowe application.
[runContract] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad received ContractFinished Nothing.
[Stop] Instance 14a6f69f-ebb3-44fe-87b5-81ebe5e6f4ad stopped.
[Stop] Instance af96e390-a708-4b5d-9496-fb25143cf64f stopped.
***** SUCCEEDED *****
