
***** Test "Zero-Coupon Bond with Immediate Timeout" *****
[Comment] is test case closes the contract immediately after creation.
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[createWallet] Mnemonic sentence is "wreck exotic tiny vacant tuna father recipe young spirit cake mixed opera prevent play mule radio bike source buzz inquiry catch thunder canvas more".
[createWallet] First wallet address is addr_test1qq5e37tk5c5kfgnnj5n5ecwrqh00t5xckc82vapgmu6n8u98dwtjxlkpjscusg3x0fv53vu90y6ql3vsckm83krg65jst9fywl.
[createWallet] First public key hash is 2998f976a62964a27395274ce1c305def5d0d8b60ea67428df3533f0.
[CreateWallet] Created wallet identified as edfa2ca1066a642eece7744360909cc3b3dbd6bc for role "Lender".
[FundWallet] Funded wallet for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance "LenderApp" with identifier 34d0ee42-362d-4d28-b4b4-bb695a9724cf for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received NewObservableState Null.
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received NewYieldedExportTxs [].
[createWallet] Mnemonic sentence is "cry movie meat minute wedding borrow increase dismiss fashion test series wing shrimp cluster deposit mistake color pencil belt consider rebel meadow blast render".
[createWallet] First wallet address is addr_test1qqe0gk7m9j963565hdtmm5wl0flgrqgw2wc7jqs6r7tptd4ps8wqjm95jh7t59hp4w6gm4puaw34klaye2fqal73n8pqac0l6v.
[createWallet] First public key hash is 32f45bdb2c8ba8d354bb57bdd1df7a7e81810e53b1e9021a1f9615b6.
[CreateWallet] Created wallet identified as 8f90b118c5f265d94ee5efccdb367f1f5d8110ef for role "Borrower".
[FundWallet] Funded wallet for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance "BorrowerApp" with identifier ab18f292-4884-465b-9110-fd5c846c2d6c for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance ab18f292-4884-465b-9110-fd5c846c2d6c received NewObservableState Null.
[runContract] Instance ab18f292-4884-465b-9110-fd5c846c2d6c received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance ab18f292-4884-465b-9110-fd5c846c2d6c received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance "LenderApp" for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "2998f976a62964a27395274ce1c305def5d0d8b60ea67428df3533f0")) (StakeRefBase (KeyHashObj (KeyHash "a76b97237ec19431c822267a5948b38579340fc590c5b678d868d525"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "32f45bdb2c8ba8d354bb57bdd1df7a7e81810e53b1e9021a1f9615b6")) (StakeRefBase (KeyHashObj (KeyHash "a181dc096cb495fcba16e1abb48dd43ceba35b7fa4ca920effd199c2")))))].
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received NewActiveEndpoints [].
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received NewObservableState (Object (fromList [("contents",Array [String "133c571e-fb2e-422d-996a-40844235bb76",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "622fd903967f7f1dadd5294ccf940edbe2da3e6c62f6708cb89945e2"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "2e9df35924498df635ab53816b666f6f5279d2a15643a4ffc6c013d3")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed for app address addr_test1wr9x20k04tw2mtw7e87yvkeawhsjnzy5c9x0wqwjhg9tz7cgzhe8a and role address addr_test1wp3zlkgrjelh78dd6555enu5pmd79k37d330vuyvhzv5tcst8skyf with MarloweParams {rolePayoutValidatorHash = 622fd903967f7f1dadd5294ccf940edbe2da3e6c62f6708cb89945e2, rolesCurrency = 2e9df35924498df635ab53816b666f6f5279d2a15643a4ffc6c013d3}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75537874),(AssetId "2e9df35924498df635ab53816b666f6f5279d2a15643a4ffc6c013d3" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "2e9df35924498df635ab53816b666f6f5279d2a15643a4ffc6c013d3" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance "BorrowerApp" now follows instance "LenderApp".
[Comment] Since the timeout has expired, the lender closes the contract, receiving their 2 ADA back.
[CallApplyInputs] Endpoint "apply-inputs" called on instance "LenderApp" for inputs [] and times Just (POSIXTime {getPOSIXTime = 1646094122000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received NewActiveEndpoints [].
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received NewObservableState (Object (fromList [("contents",Array [String "ab2a2237-ae17-447d-a9ac-900c26b310c1",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender now has paid up to another 2 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,76602880),(AssetId "2e9df35924498df635ab53816b666f6f5279d2a15643a4ffc6c013d3" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "2e9df35924498df635ab53816b666f6f5279d2a15643a4ffc6c013d3" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet for role "Lender".
[ReturnFunds] Returned funds from wallet for role "Borrower".
[Comment] Stop the Marlowe application.
[runContract] Instance 34d0ee42-362d-4d28-b4b4-bb695a9724cf received ContractFinished Nothing.
[Stop] Instance "LenderApp" stopped.
[Stop] Instance "BorrowerApp" stopped.
***** PASSED *****
[runContract] Instance ab18f292-4884-465b-9110-fd5c846c2d6c received ContractFinished Nothing.
