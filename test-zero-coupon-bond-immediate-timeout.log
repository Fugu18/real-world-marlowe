
***** Test "Zero-Coupon Bond with Immediate Timeout" *****
[Comment] is test case closes the contract immediately after creation.
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[createWallet] Mnemonic sentence is "ginger pill foil limit shoe harbor task salmon rate rough lion raw enlist use sketch antenna amused embody journey shuffle text since together capital".
[createWallet] First wallet address is addr_test1qpn6wce9aygfm6h3ps9j45lhylrlsr5egdw8txqghuhayvzjf7zmhdsnqrdt69v2nz28p9gtr6l5tgt242lfdva7pepsnznmua.
[createWallet] First public key hash is 67a76325e9109deaf10c0b2ad3f727c7f80e99435c759808bf2fd230.
[CreateWallet] Created wallet identified as cf52ff66835fa3e02ef91175287628e7acd457b2 for role "Lender".
[FundWallet] Funded wallet for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance "LenderApp" with identifier e4bab537-14a9-44a2-a1db-51a917d97014 for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received NewObservableState Null.
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received NewYieldedExportTxs [].
[createWallet] Mnemonic sentence is "discover stumble inject cruel winter vocal frame second news puzzle walnut merry stable razor amateur injury truth scene suggest time perfect glare elite ecology".
[createWallet] First wallet address is addr_test1qzc538t20q6u8ysazt97qfm7n0s989668j7stkkmfdqlfysss45ys75nrzlxarkqg2rjhnqrzuraut9c8nrcx2pjltgq8vc9j7.
[createWallet] First public key hash is b1489d6a7835c3921d12cbe0277e9be053975a3cbd05dadb4b41f492.
[CreateWallet] Created wallet identified as 7b624b0da81fbef5b61ddd2e009b4c15bf6e7bfe for role "Borrower".
[FundWallet] Funded wallet for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance "BorrowerApp" with identifier 8e5f9df2-5060-451c-9685-99514ebfa9c6 for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance 8e5f9df2-5060-451c-9685-99514ebfa9c6 received NewObservableState Null.
[runContract] Instance 8e5f9df2-5060-451c-9685-99514ebfa9c6 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 8e5f9df2-5060-451c-9685-99514ebfa9c6 received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance "LenderApp" for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "67a76325e9109deaf10c0b2ad3f727c7f80e99435c759808bf2fd230")) (StakeRefBase (KeyHashObj (KeyHash "524f85bbb61300dabd158a989470950b1ebf45a16aaabe96b3be0e43"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "b1489d6a7835c3921d12cbe0277e9be053975a3cbd05dadb4b41f492")) (StakeRefBase (KeyHashObj (KeyHash "108568487a9318be6e8ec042872bcc031707de2cb83cc7832832fad0")))))].
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received NewActiveEndpoints [].
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received NewObservableState (Object (fromList [("contents",Array [String "c97eab51-3a79-4dff-9784-5f3b6442d01d",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "7eede8eee4e2f06105c21524b169d141e303ce63709c4f49f0d01bc5"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "33f80a1972f2e48db9b9ebae08dcbdb4be2f3ef89096b82f80ba2e2c")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed for app address addr_test1wpk0l5cwytnr9lc2ltznj8df8hfe7mraccgzv4x3kqjrenqcgfyc0 and role address addr_test1wplwm68wun30qcg9cg2jfvtf69q7xq7wvdcfcn6f7rgph3g78nf5g with MarloweParams {rolePayoutValidatorHash = 7eede8eee4e2f06105c21524b169d141e303ce63709c4f49f0d01bc5, rolesCurrency = 33f80a1972f2e48db9b9ebae08dcbdb4be2f3ef89096b82f80ba2e2c}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75537874),(AssetId "33f80a1972f2e48db9b9ebae08dcbdb4be2f3ef89096b82f80ba2e2c" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "33f80a1972f2e48db9b9ebae08dcbdb4be2f3ef89096b82f80ba2e2c" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance "BorrowerApp" now follows instance "LenderApp".
[Comment] Since the timeout has expired, the lender closes the contract, receiving their 2 ADA back.
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received NewActiveEndpoints [].
[CallApplyInputs] Endpoint "apply-inputs" called on instance "LenderApp" for inputs [] and times Just (POSIXTime {getPOSIXTime = 1646094122000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received NewObservableState (Object (fromList [("contents",Array [String "d42008cf-c163-489e-a334-b6c5d7893236",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender now has paid up to another 2 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,76602880),(AssetId "33f80a1972f2e48db9b9ebae08dcbdb4be2f3ef89096b82f80ba2e2c" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "33f80a1972f2e48db9b9ebae08dcbdb4be2f3ef89096b82f80ba2e2c" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet for role "Lender".
[ReturnFunds] Returned funds from wallet for role "Borrower".
[Comment] Stop the Marlowe application.
[runContract] Instance e4bab537-14a9-44a2-a1db-51a917d97014 received ContractFinished Nothing.
[Stop] Instance "LenderApp" stopped.
[Stop] Instance "BorrowerApp" stopped.
***** PASSED *****
