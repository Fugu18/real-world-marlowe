
***** Test "Zero-Coupon Bond with Immediate Timeout" *****
[Comment] is test case closes the contract immediately after creation.
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[CreateWallet] Created wallet a8ce7b836edc7526099e55c05201a7bd1a75d1e2 for role "Lender".
[FundWallet] Funded wallet a8ce7b836edc7526099e55c05201a7bd1a75d1e2 for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received NewObservableState Null.
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received NewYieldedExportTxs [].
[CreateWallet] Created wallet 39e941a93ac338e8f6c5aee203c9d755b1c694ad for role "Borrower".
[FundWallet] Funded wallet 39e941a93ac338e8f6c5aee203c9d755b1c694ad for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance be4f1a62-fad2-4f8c-8eb6-ee4dbb27decb for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance be4f1a62-fad2-4f8c-8eb6-ee4dbb27decb received NewObservableState Null.
[runContract] Instance be4f1a62-fad2-4f8c-8eb6-ee4dbb27decb received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance be4f1a62-fad2-4f8c-8eb6-ee4dbb27decb received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "891e477cc912af04ad5cb8e585d5aac7a6460075cdf8433e25f84c8f")) (StakeRefBase (KeyHashObj (KeyHash "6cac20be02792638773a36097862a65fa309cdbcf3b2702110d3fdb0"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "ccac8733a0d6151fe588ca99e81141e350d03f334f83332a25e10072")) (StakeRefBase (KeyHashObj (KeyHash "87acabebb77dbf04bee0c00e0448aabcaa543e0f0505bf881c9b54dc")))))].
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received NewActiveEndpoints [].
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received NewObservableState (Object (fromList [("contents",Array [String "55ea29ea-75a5-4eba-b996-0eedfb4bd76b",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "69d2a789ba8c3e59c8e960e5b93f38507ec903896012c2543774b186"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "7694a8c9c68675c329f9cefa81f752460d3a28b5952f2e67ae2c5aac")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed with MarloweParams {rolePayoutValidatorHash = 69d2a789ba8c3e59c8e960e5b93f38507ec903896012c2543774b186, rolesCurrency = 7694a8c9c68675c329f9cefa81f752460d3a28b5952f2e67ae2c5aac}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75537874),(AssetId "7694a8c9c68675c329f9cefa81f752460d3a28b5952f2e67ae2c5aac" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "7694a8c9c68675c329f9cefa81f752460d3a28b5952f2e67ae2c5aac" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance be4f1a62-fad2-4f8c-8eb6-ee4dbb27decb now follows instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0.
[Comment] Since the timeout has expired, the lender closes the contract, receiving their 2 ADA back.
[CallApplyInputs] Endpoint "apply-inputs" called on 340ba070-d869-4a0e-b6a1-83f8c085b7b0 for inputs [] and times Just (POSIXTime {getPOSIXTime = 1646094122000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received NewActiveEndpoints [].
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received NewObservableState (Object (fromList [("contents",Array [String "1264d902-5977-4c70-9f38-9a414d30d76d",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender now has paid up to another 2 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,76627900),(AssetId "7694a8c9c68675c329f9cefa81f752460d3a28b5952f2e67ae2c5aac" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "7694a8c9c68675c329f9cefa81f752460d3a28b5952f2e67ae2c5aac" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet a8ce7b836edc7526099e55c05201a7bd1a75d1e2.
[ReturnFunds] Returned funds from wallet 39e941a93ac338e8f6c5aee203c9d755b1c694ad.
[Comment] Stop the Marlowe application.
[runContract] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 received ContractFinished Nothing.
[Stop] Instance 340ba070-d869-4a0e-b6a1-83f8c085b7b0 stopped.
[Stop] Instance be4f1a62-fad2-4f8c-8eb6-ee4dbb27decb stopped.
***** SUCCEEDED *****
[runContract] Instance be4f1a62-fad2-4f8c-8eb6-ee4dbb27decb received ContractFinished Nothing.
