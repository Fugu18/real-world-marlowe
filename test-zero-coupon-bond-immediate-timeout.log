
***** Test "Zero-Coupon Bond with Immediate Timeout" *****
[Comment] is test case closes the contract immediately after creation.
[Comment] Create the wallet for the lender, fund it with 80 ADA, and activate the Marlowe endpoints.
[CreateWallet] Created wallet 9e11f9d48ebf215e668eeb6ff5b0f5d97f5fd97c for role "Lender".
[FundWallet] Funded wallet 9e11f9d48ebf215e668eeb6ff5b0f5d97f5fd97c for role "Lender" with valueFromList [(AdaAssetId,80000000)].
[ActivateApp] Activated MarloweApp instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 for role "Lender".
[Comment] Create the wallet for the borrower and fund it with 10 ADA, and activate the Marlowe endpoints.
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received NewObservableState Null.
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received NewYieldedExportTxs [].
[CreateWallet] Created wallet 4383cf3f907ffdaa162ca013b385bfc14c496bf9 for role "Borrower".
[FundWallet] Funded wallet 4383cf3f907ffdaa162ca013b385bfc14c496bf9 for role "Borrower" with valueFromList [(AdaAssetId,10000000)].
[ActivateApp] Activated MarloweApp instance af6c2c3f-afaf-4b7a-808a-1839dc611aa5 for role "Borrower".
[Comment] Show the contents of the wallets.
[runContract] Instance af6c2c3f-afaf-4b7a-808a-1839dc611aa5 received NewObservableState Null.
[runContract] Instance af6c2c3f-afaf-4b7a-808a-1839dc611aa5 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[runContract] Instance af6c2c3f-afaf-4b7a-808a-1839dc611aa5 received NewYieldedExportTxs [].
[PrintWallet] Wallet for role "Lender" contains valueFromList [(AdaAssetId,80000000)].
[PrintWallet] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,10000000)].
[Comment] The lender creates the ZCB contract, which was downloaded from Marlowe Playground. The loan amount is 50 ADA and the interest amount is 3 ADA.
[CallCreate] Endpoint "create" called on instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 for owners [("Lender",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "57a2754cfa5257c0a131c795c9476cdb4d57dbd8dd65911c3e5f775f")) (StakeRefBase (KeyHashObj (KeyHash "7f12f69840a926a678d2699e3e3e5b805e74e5b740cf192abdf24a41"))))),("Borrower",AddressInEra (ShelleyAddressInEra ShelleyBasedEraShelley) (ShelleyAddress Testnet (KeyHashObj (KeyHash "5d8274a20535571c7425399e6f365811584fc00a14b83965f1bec35d")) (StakeRefBase (KeyHashObj (KeyHash "1cb5054eaf09ad920a42934c80a4cc00c0316d632683eeaa1b4e1966")))))].
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received NewActiveEndpoints [].
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received NewObservableState (Object (fromList [("contents",Array [String "29ef9788-088b-4eb4-8d12-cbaf9dac430d",Object (fromList [("contents",Object (fromList [("rolePayoutValidatorHash",String "82a92f7ed33b47d5332c5521e707ddd586c38f5e306add9166e1efa4"),("rolesCurrency",Object (fromList [("unCurrencySymbol",String "9e1ac96804d75cede32e0b7ff5a7d8df0e82182a89d5ab1e29736406")]))])),("tag",String "CreateResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitCreate] Creation confirmed with MarloweParams {rolePayoutValidatorHash = 82a92f7ed33b47d5332c5521e707ddd586c38f5e306add9166e1efa4, rolesCurrency = 9e1ac96804d75cede32e0b7ff5a7d8df0e82182a89d5ab1e29736406}.
[Comment] The lender should have about 76 ADA now, since 2 ADA was sent to the script address when creating the contract, 2 ADA was sent the borrower along with the role token, and up to 1 ADA in fees might have been paid.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,75509500),(AssetId "9e1ac96804d75cede32e0b7ff5a7d8df0e82182a89d5ab1e29736406" "Lender",1)].
[Comment] The borrower should now have their original 10 ADA plus the 2 ADA that arrived with the role token.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "9e1ac96804d75cede32e0b7ff5a7d8df0e82182a89d5ab1e29736406" "Borrower",1)].
[Comment] The borrower needs to follow this contract in order to interact with it.
[Follow] Instance af6c2c3f-afaf-4b7a-808a-1839dc611aa5 now follows instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8.
[Comment] Since the timeout has expired, the lender closes the contract, receiving their 2 ADA back.
[CallApplyInputs] Endpoint "apply-inputs" called on f4cebaee-6f60-45c9-a8c8-12f8e19646b8 for inputs [] and times Just (POSIXTime {getPOSIXTime = 1646094122000},POSIXTime {getPOSIXTime = 1898051625000}).
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received NewActiveEndpoints [].
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received NewObservableState (Object (fromList [("contents",Array [String "6018d9d5-78f3-43d2-94df-f1e36733b03f",Object (fromList [("tag",String "ApplyInputsResponse")])]),("tag",String "EndpointSuccess")])).
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received NewActiveEndpoints [ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "close"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "redeem"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "auto"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs-nonmerkleized"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "apply-inputs"}, aeMetadata = Nothing},ActiveEndpoint {aeDescription = EndpointDescription {getEndpointDescription = "create"}, aeMetadata = Nothing}].
[AwaitApplyInputs] Input application confirmed.
[Comment] The lender now has paid up to another 2 ADA in fees.
[CheckFunds] Wallet for role "Lender" contains valueFromList [(AdaAssetId,76496288),(AssetId "9e1ac96804d75cede32e0b7ff5a7d8df0e82182a89d5ab1e29736406" "Lender",1)].
[Comment] The borrower's funds are unchanged.
[CheckFunds] Wallet for role "Borrower" contains valueFromList [(AdaAssetId,12000000),(AssetId "9e1ac96804d75cede32e0b7ff5a7d8df0e82182a89d5ab1e29736406" "Borrower",1)].
[Comment] Return unused funds.
[ReturnFunds] Returned funds from wallet 9e11f9d48ebf215e668eeb6ff5b0f5d97f5fd97c.
[ReturnFunds] Returned funds from wallet 4383cf3f907ffdaa162ca013b385bfc14c496bf9.
[Comment] Stop the Marlowe application.
[runContract] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 received ContractFinished Nothing.
[Stop] Instance f4cebaee-6f60-45c9-a8c8-12f8e19646b8 stopped.
[Stop] Instance af6c2c3f-afaf-4b7a-808a-1839dc611aa5 stopped.
***** SUCCEEDED *****
[runContract] Instance af6c2c3f-afaf-4b7a-808a-1839dc611aa5 received ContractFinished Nothing.
